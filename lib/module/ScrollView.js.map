{"version":3,"sources":["ScrollView.tsx"],"names":["React","Animated","IS_IOS","useAfterMountEffect","useChainCallback","useCollapsibleStyle","useScrollHandlerY","useSharedAnimatedRef","useTabNameContext","useTabsContext","useUpdateScrollViewContentSize","ScrollView","forwardRef","contentContainerStyle","style","onContentSizeChange","children","refreshControl","rest","passRef","name","ref","setRef","contentInset","scrollYCurrent","_style","_contentContainerStyle","progressViewOffset","canBindScrollEvent","setCanBindScrollEvent","useState","scrollHandler","enabled","useEffect","scrollContentSizeChange","scrollContentSizeChangeHandlers","top","y","value","x","cloneElement","props"],"mappings":";;AAAA,OAAOA,KAAP,MAAkB,OAAlB;AAGA,OAAOC,QAAP,MAAqB,yBAArB;AAEA,SAASC,MAAT,QAAuB,WAAvB;AACA,SACEC,mBADF,EAEEC,gBAFF,EAGEC,mBAHF,EAIEC,iBAJF,EAKEC,oBALF,EAMEC,iBANF,EAOEC,cAPF,EAQEC,8BARF,QASO,SATP;AAWA;AACA;AACA;;AACA,OAAO,MAAMC,UAAU,gBAAGX,KAAK,CAACY,UAAN,CAIxB,CACE;AACEC,EAAAA,qBADF;AAEEC,EAAAA,KAFF;AAGEC,EAAAA,mBAHF;AAIEC,EAAAA,QAJF;AAKEC,EAAAA,cALF;AAME,KAAGC;AANL,CADF,EASEC,OATF,KAUK;AACH,QAAMC,IAAI,GAAGZ,iBAAiB,EAA9B;AACA,QAAMa,GAAG,GAAGd,oBAAoB,CAAMY,OAAN,CAAhC;AACA,QAAM;AAAEG,IAAAA,MAAF;AAAUC,IAAAA,YAAV;AAAwBC,IAAAA;AAAxB,MAA2Cf,cAAc,EAA/D;AACA,QAAM;AACJK,IAAAA,KAAK,EAAEW,MADH;AAEJZ,IAAAA,qBAAqB,EAAEa,sBAFnB;AAGJC,IAAAA;AAHI,MAIFtB,mBAAmB,EAJvB;AAKA,QAAM,CAACuB,kBAAD,EAAqBC,qBAArB,IAA8C7B,KAAK,CAAC8B,QAAN,CAAe,KAAf,CAApD;AAEA3B,EAAAA,mBAAmB,CAAC,MAAM;AACxB;AACA;AACA0B,IAAAA,qBAAqB,CAAC,IAAD,CAArB;AACD,GAJkB,CAAnB;AAMA,QAAME,aAAa,GAAGzB,iBAAiB,CAACc,IAAD,EAAO;AAC5CY,IAAAA,OAAO,EAAEJ;AADmC,GAAP,CAAvC;AAIA5B,EAAAA,KAAK,CAACiC,SAAN,CAAgB,MAAM;AACpBX,IAAAA,MAAM,CAACF,IAAD,EAAOC,GAAP,CAAN;AACD,GAFD,EAEG,CAACD,IAAD,EAAOC,GAAP,EAAYC,MAAZ,CAFH;AAIA,QAAMY,uBAAuB,GAAGxB,8BAA8B,CAAC;AAC7DU,IAAAA;AAD6D,GAAD,CAA9D;AAIA,QAAMe,+BAA+B,GAAG/B,gBAAgB,CACtD8B,uBADsD,EAEtDnB,mBAFsD,CAAxD;AAKA,sBACE,oBAAC,QAAD,CAAU,UAAV,eACMG,IADN;AAEE,IAAA,GAAG,EAAEG,GAFP;AAGE,IAAA,WAAW,EAAE,KAHf;AAIE,IAAA,KAAK,EAAE,CAACI,MAAD,EAASX,KAAT,CAJT;AAKE,IAAA,qBAAqB,EAAE,CACrBY,sBADqB,EAErB;AACAb,IAAAA,qBAHqB,CALzB;AAUE,IAAA,QAAQ,EAAEkB,aAVZ;AAWE,IAAA,mBAAmB,EAAEI,+BAXvB;AAYE,IAAA,mBAAmB,EAAE,EAZvB;AAaE,IAAA,YAAY,EAAE;AAAEC,MAAAA,GAAG,EAAEb;AAAP,KAbhB;AAcE,IAAA,aAAa,EAAE;AACbc,MAAAA,CAAC,EAAEnC,MAAM,GAAG,CAACqB,YAAD,GAAgBC,cAAc,CAACc,KAAlC,GAA0C,CADtC;AAEbC,MAAAA,CAAC,EAAE;AAFU,KAdjB;AAkBE,IAAA,gCAAgC,EAAE,KAlBpC;AAmBE,IAAA,cAAc,EACZtB,cAAc,iBACdjB,KAAK,CAACwC,YAAN,CAAmBvB,cAAnB,EAAmC;AACjCU,MAAAA,kBADiC;AAEjC,SAAGV,cAAc,CAACwB;AAFe,KAAnC;AArBJ,MA2BGzB,QA3BH,CADF;AA+BD,CA/EuB,CAAnB","sourcesContent":["import React from 'react'\nimport { ScrollViewProps } from 'react-native'\nimport { ScrollView as RNScrollView } from 'react-native-gesture-handler'\nimport Animated from 'react-native-reanimated'\n\nimport { IS_IOS } from './helpers'\nimport {\n  useAfterMountEffect,\n  useChainCallback,\n  useCollapsibleStyle,\n  useScrollHandlerY,\n  useSharedAnimatedRef,\n  useTabNameContext,\n  useTabsContext,\n  useUpdateScrollViewContentSize,\n} from './hooks'\n\n/**\n * Use like a regular ScrollView.\n */\nexport const ScrollView = React.forwardRef<\n  RNScrollView,\n  React.PropsWithChildren<Omit<ScrollViewProps, 'onScroll'>>\n>(\n  (\n    {\n      contentContainerStyle,\n      style,\n      onContentSizeChange,\n      children,\n      refreshControl,\n      ...rest\n    },\n    passRef\n  ) => {\n    const name = useTabNameContext()\n    const ref = useSharedAnimatedRef<any>(passRef)\n    const { setRef, contentInset, scrollYCurrent } = useTabsContext()\n    const {\n      style: _style,\n      contentContainerStyle: _contentContainerStyle,\n      progressViewOffset,\n    } = useCollapsibleStyle()\n    const [canBindScrollEvent, setCanBindScrollEvent] = React.useState(false)\n\n    useAfterMountEffect(() => {\n      // we enable the scroll event after mounting\n      // otherwise we get an `onScroll` call with the initial scroll position which can break things\n      setCanBindScrollEvent(true)\n    })\n\n    const scrollHandler = useScrollHandlerY(name, {\n      enabled: canBindScrollEvent,\n    })\n\n    React.useEffect(() => {\n      setRef(name, ref)\n    }, [name, ref, setRef])\n\n    const scrollContentSizeChange = useUpdateScrollViewContentSize({\n      name,\n    })\n\n    const scrollContentSizeChangeHandlers = useChainCallback(\n      scrollContentSizeChange,\n      onContentSizeChange\n    )\n\n    return (\n      <Animated.ScrollView\n        {...rest}\n        ref={ref}\n        bouncesZoom={false}\n        style={[_style, style]}\n        contentContainerStyle={[\n          _contentContainerStyle,\n          // TODO: investigate types\n          contentContainerStyle as any,\n        ]}\n        onScroll={scrollHandler}\n        onContentSizeChange={scrollContentSizeChangeHandlers}\n        scrollEventThrottle={16}\n        contentInset={{ top: contentInset }}\n        contentOffset={{\n          y: IS_IOS ? -contentInset + scrollYCurrent.value : 0,\n          x: 0,\n        }}\n        automaticallyAdjustContentInsets={false}\n        refreshControl={\n          refreshControl &&\n          React.cloneElement(refreshControl, {\n            progressViewOffset,\n            ...refreshControl.props,\n          })\n        }\n      >\n        {children}\n      </Animated.ScrollView>\n    )\n  }\n)\n"]}