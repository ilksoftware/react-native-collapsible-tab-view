{"version":3,"sources":["ScrollView.tsx"],"names":["ScrollView","React","forwardRef","contentContainerStyle","style","onContentSizeChange","children","refreshControl","rest","passRef","name","ref","setRef","contentInset","scrollYCurrent","_style","_contentContainerStyle","progressViewOffset","canBindScrollEvent","setCanBindScrollEvent","useState","scrollHandler","enabled","useEffect","scrollContentSizeChange","scrollContentSizeChangeHandlers","top","y","IS_IOS","value","x","cloneElement","props"],"mappings":";;;;;;;AAAA;;AAEA;;AAEA;;AACA;;;;;;AAWA;AACA;AACA;AACO,MAAMA,UAAU,gBAAGC,eAAMC,UAAN,CAIxB,CACE;AACEC,EAAAA,qBADF;AAEEC,EAAAA,KAFF;AAGEC,EAAAA,mBAHF;AAIEC,EAAAA,QAJF;AAKEC,EAAAA,cALF;AAME,KAAGC;AANL,CADF,EASEC,OATF,KAUK;AACH,QAAMC,IAAI,GAAG,+BAAb;AACA,QAAMC,GAAG,GAAG,iCAAmCF,OAAnC,CAAZ;AACA,QAAM;AAAEG,IAAAA,MAAF;AAAUC,IAAAA,YAAV;AAAwBC,IAAAA;AAAxB,MAA2C,4BAAjD;AACA,QAAM;AACJV,IAAAA,KAAK,EAAEW,MADH;AAEJZ,IAAAA,qBAAqB,EAAEa,sBAFnB;AAGJC,IAAAA;AAHI,MAIF,iCAJJ;;AAKA,QAAM,CAACC,kBAAD,EAAqBC,qBAArB,IAA8ClB,eAAMmB,QAAN,CAAe,KAAf,CAApD;;AAEA,kCAAoB,MAAM;AACxB;AACA;AACAD,IAAAA,qBAAqB,CAAC,IAAD,CAArB;AACD,GAJD;AAMA,QAAME,aAAa,GAAG,8BAAkBX,IAAlB,EAAwB;AAC5CY,IAAAA,OAAO,EAAEJ;AADmC,GAAxB,CAAtB;;AAIAjB,iBAAMsB,SAAN,CAAgB,MAAM;AACpBX,IAAAA,MAAM,CAACF,IAAD,EAAOC,GAAP,CAAN;AACD,GAFD,EAEG,CAACD,IAAD,EAAOC,GAAP,EAAYC,MAAZ,CAFH;;AAIA,QAAMY,uBAAuB,GAAG,2CAA+B;AAC7Dd,IAAAA;AAD6D,GAA/B,CAAhC;AAIA,QAAMe,+BAA+B,GAAG,6BACtCD,uBADsC,EAEtCnB,mBAFsC,CAAxC;AAKA,sBACE,6BAAC,8BAAD,CAAU,UAAV,eACMG,IADN;AAEE;AACA,IAAA,GAAG,EAAEG,GAHP;AAIE,IAAA,WAAW,EAAE,KAJf;AAKE,IAAA,KAAK,EAAE,CAACI,MAAD,EAASX,KAAT,CALT;AAME,IAAA,qBAAqB,EAAE,CACrBY,sBADqB,EAErB;AACAb,IAAAA,qBAHqB,CANzB;AAWE,IAAA,QAAQ,EAAEkB,aAXZ;AAYE,IAAA,mBAAmB,EAAEI,+BAZvB;AAaE,IAAA,mBAAmB,EAAE,EAbvB;AAcE,IAAA,YAAY,EAAE;AAAEC,MAAAA,GAAG,EAAEb;AAAP,KAdhB;AAeE,IAAA,aAAa,EAAE;AACbc,MAAAA,CAAC,EAAEC,kBAAS,CAACf,YAAD,GAAgBC,cAAc,CAACe,KAAxC,GAAgD,CADtC;AAEbC,MAAAA,CAAC,EAAE;AAFU,KAfjB;AAmBE,IAAA,gCAAgC,EAAE,KAnBpC;AAoBE,IAAA,cAAc,EACZvB,cAAc,iBACdN,eAAM8B,YAAN,CAAmBxB,cAAnB,EAAmC;AACjCU,MAAAA,kBADiC;AAEjC,SAAGV,cAAc,CAACyB;AAFe,KAAnC;AAtBJ,MA4BG1B,QA5BH,CADF;AAgCD,CAhFuB,CAAnB","sourcesContent":["import React from 'react'\nimport { ScrollViewProps, ScrollView as RNScrollView } from 'react-native'\nimport Animated from 'react-native-reanimated'\n\nimport { IS_IOS } from './helpers'\nimport {\n  useAfterMountEffect,\n  useChainCallback,\n  useCollapsibleStyle,\n  useScrollHandlerY,\n  useSharedAnimatedRef,\n  useTabNameContext,\n  useTabsContext,\n  useUpdateScrollViewContentSize,\n} from './hooks'\n\n/**\n * Use like a regular ScrollView.\n */\nexport const ScrollView = React.forwardRef<\n  RNScrollView,\n  React.PropsWithChildren<Omit<ScrollViewProps, 'onScroll'>>\n>(\n  (\n    {\n      contentContainerStyle,\n      style,\n      onContentSizeChange,\n      children,\n      refreshControl,\n      ...rest\n    },\n    passRef\n  ) => {\n    const name = useTabNameContext()\n    const ref = useSharedAnimatedRef<RNScrollView>(passRef)\n    const { setRef, contentInset, scrollYCurrent } = useTabsContext()\n    const {\n      style: _style,\n      contentContainerStyle: _contentContainerStyle,\n      progressViewOffset,\n    } = useCollapsibleStyle()\n    const [canBindScrollEvent, setCanBindScrollEvent] = React.useState(false)\n\n    useAfterMountEffect(() => {\n      // we enable the scroll event after mounting\n      // otherwise we get an `onScroll` call with the initial scroll position which can break things\n      setCanBindScrollEvent(true)\n    })\n\n    const scrollHandler = useScrollHandlerY(name, {\n      enabled: canBindScrollEvent,\n    })\n\n    React.useEffect(() => {\n      setRef(name, ref)\n    }, [name, ref, setRef])\n\n    const scrollContentSizeChange = useUpdateScrollViewContentSize({\n      name,\n    })\n\n    const scrollContentSizeChangeHandlers = useChainCallback(\n      scrollContentSizeChange,\n      onContentSizeChange\n    )\n\n    return (\n      <Animated.ScrollView\n        {...rest}\n        // @ts-expect-error reanimated types are broken on ref\n        ref={ref}\n        bouncesZoom={false}\n        style={[_style, style]}\n        contentContainerStyle={[\n          _contentContainerStyle,\n          // TODO: investigate types\n          contentContainerStyle as any,\n        ]}\n        onScroll={scrollHandler}\n        onContentSizeChange={scrollContentSizeChangeHandlers}\n        scrollEventThrottle={16}\n        contentInset={{ top: contentInset }}\n        contentOffset={{\n          y: IS_IOS ? -contentInset + scrollYCurrent.value : 0,\n          x: 0,\n        }}\n        automaticallyAdjustContentInsets={false}\n        refreshControl={\n          refreshControl &&\n          React.cloneElement(refreshControl, {\n            progressViewOffset,\n            ...refreshControl.props,\n          })\n        }\n      >\n        {children}\n      </Animated.ScrollView>\n    )\n  }\n)\n"]}